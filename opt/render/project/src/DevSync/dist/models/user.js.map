{"version":3,"file":"user.js","names":["mongoose","require","Schema","userSchema","name","first","type","String","required","last","username","passwordHash","email","plan","default","emailVerified","Boolean","statics","isValidUsername","user","find","length","err","console","error","isUniqueEmail","isUniqueUsername","isValidUser","User","findOne","log","model","module","exports"],"sources":["../../models/user.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst Schema = mongoose.Schema;\r\n\r\nconst userSchema = new Schema({\r\n  name:{\r\n    first:{\r\n      type:String,\r\n      required:true\r\n    },\r\n    last:{\r\n      type:String,\r\n    }\r\n  },\r\n  username: {\r\n    type:String,\r\n    required:true\r\n  },\r\n  passwordHash: {\r\n    type:String,\r\n    required:true\r\n  },\r\n  email:{\r\n    type:String,\r\n    required:true\r\n  },\r\n  plan:{\r\n    type:String,\r\n    default:'basic'\r\n  },\r\n  emailVerified:{\r\n    type:Boolean,\r\n    default:false\r\n  }\r\n})\r\nuserSchema.statics.isValidUsername = async function(username){\r\n  try{\r\n    const user = await this.find({username:username});\r\n    if(user.length>0) return false;\r\n    else return true;\r\n  }catch(err){\r\n    console.error('Error while validating username: ',err);\r\n  }\r\n}\r\nuserSchema.statics.isUniqueEmail = async function(email){\r\n  try{\r\n    const user = await this.find({email:email});\r\n    if(user.length>0) return false;\r\n    else return true;\r\n  }catch(err){\r\n    console.error('Error while validating email: ',err);\r\n  }\r\n}\r\nuserSchema.statics.isUniqueUsername = async function(username){\r\n  try{\r\n    const user = await this.find({username:username});\r\n    if(user.length>0) return false;\r\n    else return true;\r\n  }catch(err){\r\n    console.error('Error while validating username: ',err);\r\n  }\r\n}\r\nuserSchema.statics.isValidUser = async function({username,passwordHash}){\r\n  try{\r\n    const user = await User.findOne({username:username});\r\n    console.log(user);\r\n    console.log(passwordHash);\r\n    if(!user) return [false,null];\r\n    else if(user.passwordHash === passwordHash) return [true,user];\r\n    else return [false,null];\r\n  }catch(err){\r\n    console.error('Error while validating user: ',err);\r\n  }\r\n}\r\nconst User = mongoose.model('User',userSchema);\r\nmodule.exports = User;"],"mappings":"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","ignoreList":[]}